# TWRP-specific initialization for MTP and other features

on init
    # Set up proper permissions for MTP
    chmod 0666 /dev/mtp_usb
    chown root root /dev/mtp_usb
    
    # Create required directories for TWRP MTP
    mkdir /tmp 0777 root root
    mkdir /sdcard 0777 root root
    
    # Set up USB configuration for TWRP
    setprop sys.usb.configfs 1
    setprop ro.adb.secure 0
    
    # Enable MTP debugging
    setprop persist.vendor.mtp.enable 1
    setprop persist.sys.usb.config mtp,adb

on property:twrp.mtp.enabled=1
    setprop sys.usb.config mtp,adb

on property:twrp.mtp.enabled=0
    setprop sys.usb.config adb